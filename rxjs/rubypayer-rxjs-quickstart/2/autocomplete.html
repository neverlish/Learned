<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/6.2.2/rxjs.umd.min.js"></script>
</head>
<body>
  <input type="input" id="search" placeholder="검색하고 싶은 사용자의 아이디를 입력해 주세요" />
  <script>
    const { fromEvent } = rxjs;
    const { map, mergeMap, debounceTime, filter, distinctUntilChanged } = rxjs.operators;
    const { ajax } = rxjs.ajax;

    const user$ = fromEvent(document.getElementById('search'), 'keyup')
      .pipe(
        debounceTime(300), // 300ms 뒤에 데이터를 전달한다.
        map(event => event.target.value),
        distinctUntilChanged(), // 특수키가 입력된 경우에는 나오지 않기 위해 중복 데이터 처리
        filter(query => query.trim().length > 0),
        mergeMap(query => ajax.getJSON(`https://api.github.com/search/users?q=${query}`))
      );

    user$.subscribe(value => {
      console.log('서버로부터 받은 검색 결과', value);
    });
  </script>
</body>
</html>
